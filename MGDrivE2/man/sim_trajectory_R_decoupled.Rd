% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sampling-trajectory-R-decoupled.R
\name{sim_trajectory_R_decoupled}
\alias{sim_trajectory_R_decoupled}
\title{Simulate Trajectory From a Decoupled SPN Model}
\usage{
sim_trajectory_R_decoupled(
  x0,
  h0,
  tmax,
  inf_labels,
  dt = 1,
  dt_stoch = 0.1,
  num_reps = 1,
  S,
  hazards,
  SPN_P,
  theta,
  Sout = NULL,
  sampler = "tau",
  method = "lsoda",
  events = NULL,
  batch = NULL,
  verbose = TRUE,
  human_ode = "Imperial",
  cube,
  ...
)
}
\arguments{
\item{x0}{the initial marking of the SPN (initial state, M0)}

\item{h0}{the initial human state distribution}

\item{tmax}{the final time to end simulation (all simulations start at 0)}

\item{inf_labels}{labels corresponding to female mosquito infection hazard}

\item{dt}{the time-step at which to return output (\strong{not} the time-step of the sampling algorithm)}

\item{dt_stoch}{time-step used for approximation of hazards}

\item{num_reps}{number of repetitions to run, default is 1.}

\item{S}{a stoichiometry \code{\link[Matrix]{Matrix-class}} object}

\item{hazards}{list of hazard functions}

\item{SPN_P}{stochastic Petri Net places}

\item{theta}{parameters}

\item{Sout}{an optional matrix to track event firings}

\item{sampler}{determines sampling algorithm, one of; "tau-decoupled", "ode-decoupled"}

\item{method}{if \code{sampler} is "ode-decoupled", the solver to use, from \code{deSolve}}

\item{events}{a \code{data.frame} of events, may be set to \code{NULL} if not used}

\item{batch}{a \code{list} of batch migration events, created from \code{\link[MGDrivE2]{batch_migration}}, may be set to \code{NULL} if not used}

\item{verbose}{print a progress bar?}

\item{human_ode}{human ode function}

\item{cube}{inheritance cube}

\item{...}{further named arguments passed to the step function}
}
\value{
a list with 2 elements: "state" is the array of returned state values, and "events" will
       return events tracked with \code{Sout} if provided, otherwise is \code{NULL}
}
\description{
This function provides a unified interface to the various decoupled simulation algorithms
for SPN, returning output sampled at a lattice of time points to the user, and
handling various exogenous events that may occur during the simulation
(such as release of adult mosquitoes).
}
\details{
\code{dt_stoch} is used by the Poisson Time-Step (\code{\link{step_PTS_decoupled}})
method to approximate the hazards. A smaller \code{dt_stoch} provides a better
approximation, but will take longer to run.

The stoichiometry matrix (\code{S}) is generated in \code{\link{spn_S}}.

The list of hazards (\code{hazards}) come from \code{\link{spn_hazards}}.

Two samplers are provided. The default is a Poisson Time-Step
(\code{\link{step_PTS_decoupled}}) method.
Additionally, for convenience, an ODE "sampler" (\code{\link{step_ODE_decoupled}}) is
provided for compatibility with other samplers. This function uses methods from
\code{deSolve}.

If using the \code{ode} sampler, several \code{methods} are provided in the \code{deSolve}
package, see \code{\link[deSolve]{ode}}. For inhomogeneous systems, consider
using the "rk4" method to avoid excessive integration times.

Additionally, \code{events} objects may be used for "releases", and must follow
the format required by \code{deSolve}. This means that events must be a \code{data.frame}
with four columns - \code{var}, \code{time}, \code{value}, and \code{method} -
in any order and \code{stringsAsFactors = FALSE}. \code{Events} currently must be one of two types:
\itemize{
 \item: 'add': When the \code{method} is \code{add}, this represents a classic
        release scenario. Appropriate values from the \code{value} column are
        added to the state defined in the \code{var} column at the appropriate
        moments as defined in the \code{time} column.
 \item: 'swap': The \code{swap} method is similar to a small-molecule spray, where
        a chemical is applied to the landscape and "turns-on" or "turns-off"
        genotypes. This functionality uses the states defined in the \code{value}
        column to move the counts within those states to states defined in the
        \code{var} column. Then, the state specified in the \code{value} column
        is set to \code{0}, effectively "swapping" \code{value} into \code{var}.
        Again, these events occur as specified in the \code{time} column.
}

This function tracks state variables by default; an optional argument \code{Sout}
can be provided to track number of event firings each time step (for discrete stochastic simulations),
or cumulative intensity (for continuous stochastic simulations), or the rate function of
particular events for ODE simulation. The matrix must have number of columns equal to
number of events in the system (the number of hazard functions), and a row for each tracking
variable. The function \code{\link{track_hinf}} is provided, which builds a matrix to track
human infection events.

To save output as .csv files, see \code{\link{sim_trajectory_CSV_decoupled}}.
}
